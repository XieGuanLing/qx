<div class="sbnav">
    <div class="breakcrumb breakcrumb-user">
        <ul>
            <li class="txtCrumb">Current Path：</li>
            <li class="firCrumb">Error Log</li>
        </ul>
    </div>
</div>
<div id="main">
    <div class="content_sub">

        <div class="search_form">
            <table width="100%" cellspacing="0" cellpadding="0" border="0">
                    <tbody>
                    <tr>
                        <td width="110"><label>lastTime:start</label></td>
                        <td width="200">
                            <input type="text" class="input01"
                                   date-time view="date" min-view="hours" auto-close="true"
                                   ng-model="startTime" date-change="timeChange">
                        </td>
                        <td width="110"><label>lastTime:end</label></td>
                        <td width="200"><input type="text" class="input01"
                                               date-time view="date" min-view="hours" auto-close="true"
                                               ng-model="endTime" date-change="timeChange">
                        </td>

                        <td width="110"><label>flattenMd5</label></td>
                        <td width="200"><input  class="input01" type="text" ng-model = "q.flattenMd5">
                        </td>

                        <td width="110"><label>flattenLength</label></td>
                        <td width="200"><input  class="input01" type="text" ng-model = "q.flattenLength">
                        </td>
                    </tr>
                    <tr>
                        <td width="70"><label>resolved</label></td>
                        <td width="30">
                            <input type="checkbox" class="choose-all" ng-model="q.resolved">
                        </td>

                        <td width="70"><label>sort</label></td>
                        <td width="30">
                            <select ng-model = "q.sortCondition"ng-change = "search()">
                                <option value = "lastTime" selected>lastTime</option>
                                <option value = "firstTime">firstTime</option>
                                <option value = "happenedTimes">happenedTimes</option>
                            </select>
                            <select ng-model = "q.sort" ng-change = "search()">
                                <option value = "-1" selected>desc</option>
                                <option value = "1">asc</option>
                            </select>
                        </td>

                        <td width="100">
                            <button type="button" class="btn btn-primary" ng-click="search()">Search</button>
                        </td>
                    </tr>
                    </tbody>
                </table>
        </div>

        <div class="table_list table-responsive">
            <table>
                <tbody>
                <tr>
                    <th  style="text-align:center;">_id</th>
                    <th>internalRequestIds</th>
                    <th>affectedCompanyIds</th>
                    <!--<th>stackTrace</th>-->
                    <th>apis</th>
                    <th>firstTime</th>
                    <th>lastTime</th>
                    <th>happenedTimes</th>
                    <th>operation</th>
                </tr>
                <tr ng-repeat="i in list">
                    <td align="center">{{i._id}}</td>
                    <td><span ng-repeat="item in i.internalRequestIds">{{item}}<br/></span></td>
                    <td><span ng-repeat="item in i.affectedCompanyIds">{{item}}<br/></span></td>
                    <td><span ng-repeat="item in i.apis">{{item}}<br/></span></td>
                    <td>{{i.firstTime}}</td>
                    <td>{{i.lastTime}}</td>
                    <!--<td>{{i.stackTrace}}</td>-->
                    <td>{{i.happenedTimes}}</td>
                    <td>
                        <a ui-sref="exception-logs({flattenMd5:i.flattenMd5,flattenLength:i.flattenLength})">Like
                            Error</a>
                        &nbsp;&nbsp;
                        <a ng-click="resolved(i)">Resolved</a>&nbsp;&nbsp;
                        <a ng-click="detail(i)">Stack Trace</a>
                    </td>
                </tr>
                </tbody>
                <tbody ng-show="list.length==0">
                <tr>
                    <td colspan="5">没有符合条件的数据</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="toolbar">
            <div class="toolbar_info">
                <table cellspacing="0">
                    <tbody>
                    <tr>
                        <td>
                            <button type="button" class="pg_first" ng-click="firstPage()">&nbsp;</button>
                        </td>
                        <td>
                            <button type="button" class="pg_prev" ng-click="previousPage()">&nbsp;</button>
                        </td>
                        <td><span class="ytb-sep"></span></td>
                        <td><span class="ytb-text">第{{currPage + 1}}页，</span></td>
                        <td><span class="ytb-text">共{{totalPage}}页</span></td>
                        <td><span class="ytb-sep"></span></td>
                        <td>
                            <button type="button" class="pg_next" ng-click="nextPage()">&nbsp;</button>
                        </td>
                        <td>
                            <button type="button" class="pg_last" ng-click="lastPage()">&nbsp;</button>
                        </td>
                        <td><span class="ytb-sep" id="ext-gen283"></span></td>
                        <td>
                            <button type="button" class="x-btn-text bar_load" ng-click="search();">&nbsp;</button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/ng-template" id="resolved-modal.html">
    <div class="modal-content cancel-modal">
        <div class="modal-header">
            <button type="button" class="close" ng-click="cancel()"><span>&times;</span></button>
            <h4 class="modal-title">remark</h4>
        </div>
        <div class="modal-body">
            <div class="remarkPosition">
                <label class="left">
                    remark
                </label>
                <div class="box">
                    <textarea class="form-control" ng-model="remark"
                              placeholder="remark" style="margin: 0;"></textarea>
                </div>

            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" ng-click="ok()">确定</button>
        </div>
    </div>
</script>

<script type="text/ng-template" id="exception-log-modal.html">
    <div class="modal-content cancel-modal">
        <div class="modal-header">
            <button type="button" class="close" ng-click="cancel()"><span>&times;</span></button>
            <h4 class="modal-title">stackTrace</h4>
        </div>
        <div class="modal-body">
            <pre>
            <div class="pre-scrollable">
               {{exception.stackTrace}}
            </div>
                </pre>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" ng-click="ok()">确定</button>
        </div>
    </div>
</script>